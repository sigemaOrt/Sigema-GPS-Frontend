<!-- Header con gradiente moderno -->
<nav class="navbar navbar-expand-lg navbar-dark modern-navbar">
  <div class="container-fluid">
    <span class="navbar-brand fw-bold">
      <i class="bi bi-gear-fill me-2"></i>
      Sigema APP
    </span>
    <button class="btn btn-outline-light modern-btn-outline ms-auto" (click)="logout()">
      <i class="bi bi-box-arrow-right me-1"></i>
      Salir
    </button>
  </div>
</nav>

<div class="container-fluid modern-container">
  
  <!-- Trabajo Activo - Mejorado -->
  <div *ngIf="hayTrabajoActivo" class="alert modern-alert-warning">
    <div class="alert-icon">
      <i class="bi bi-exclamation-triangle-fill"></i>
    </div>
    <div class="alert-content">
      <div class="alert-title">Trabajo en Progreso</div>
      <div class="alert-text">Equipo ID: {{ equipoEnTrabajoId }} actualmente en uso</div>
    </div>
    <div class="alert-pulse"></div>
  </div>

  <!-- Buscador moderno -->
  <div class="search-section">
    <div class="search-container">
      <div class="search-input-wrapper">
        <i class="bi bi-search search-icon"></i>
        <input 
          type="text" 
          class="modern-search-input" 
          [(ngModel)]="filtroMatricula" 
          placeholder="Buscar por matrícula...">
        <div class="search-underline"></div>
      </div>
<button 
  class="modern-refresh-btn"
  (click)="cargarEquipos()"
  [disabled]="estaActualizando">
  <i class="bi" [ngClass]="estaActualizando ? 'bi-arrow-clockwise spin' : 'bi-arrow-clockwise'"></i>
</button>

    </div>
  </div>
  <!-- Spinner de actualización moderno -->
  <div *ngIf="estaActualizando" class="loading-container">
    <div class="modern-spinner">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
    </div>
    <span class="loading-text">Actualizando equipos...</span>
  </div>

  <!-- Grid de equipos moderno -->
  <div class="equipment-grid">
    <div *ngFor="let equipo of equipos | filtroPorMatricula:filtroMatricula" 
         class="equipment-card">
      <ng-container *ngIf="equipo.modeloEquipo && equipo.modeloEquipo.marca && equipo.modeloEquipo.tipoEquipo">
        
        <!-- Header de la card -->
        <div class="card-header-modern">
          <div class="equipment-icon">
            <i class="bi bi-truck"></i>
          </div>
          <div class="equipment-title">
            <h3>{{ equipo.modeloEquipo.modelo }}</h3>
            <span class="equipment-year">({{ equipo.modeloEquipo.anio }})</span>
          </div>
          <div class="equipment-status" [ngClass]="equipo.estado.toLowerCase()">
            {{ equipo.estado }}
          </div>
        </div>

        <!-- Contenido de la card -->
        <div class="card-content-modern">
          
          <!-- Info grid -->
          <div class="info-grid">
            <div class="info-item">
              <div class="info-label">Matrícula</div>
              <div class="info-value">{{ equipo.matricula }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Capacidad</div>
              <div class="info-value">{{ equipo.modeloEquipo.capacidad }} {{ equipo.modeloEquipo.unidadMedida }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Marca</div>
              <div class="info-value">{{ equipo.modeloEquipo.marca.nombre }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Tipo</div>
              <div class="info-value">{{ equipo.modeloEquipo.tipoEquipo.nombre }}</div>
            </div>
          </div>

          <!-- Ubicación con estilo moderno -->
          <div class="location-info">
            <i class="bi bi-geo-alt-fill location-icon"></i>
            <span>{{ equipo.latitud }}, {{ equipo.longitud }}</span>
          </div>

          <!-- Status chips modernos -->
          <div class="status-chips">
            <div class="status-chip success" *ngIf="equipo.estaEnUso">
              <i class="bi bi-check-circle-fill"></i>
              <span>En Uso</span>
              <div class="chip-glow success-glow"></div>
            </div>
            <div class="status-chip secondary" *ngIf="!equipo.estaEnUso">
              <i class="bi bi-circle"></i>
              <span>Disponible</span>
            </div>
            <div class="status-chip danger" *ngIf="isBotonDeshabilitado(equipo) && !equipo.estaEnUso">
              <i class="bi bi-lock-fill"></i>
              <span>Bloqueado</span>
            </div>
          </div>

          <!-- Botón de acción moderno -->
          <button 
            class="modern-action-btn"
            [ngClass]="{
              'btn-danger': equipo.estaEnUso,
              'btn-success': !equipo.estaEnUso && !isBotonDeshabilitado(equipo),
              'btn-disabled': isBotonDeshabilitado(equipo)
            }"
            [disabled]="isBotonDeshabilitado(equipo)"
            (click)="toggleEstado(equipo.id, equipo.estaEnUso ?? false)">
            
            <div class="btn-content">
              <i class="bi" 
                 [ngClass]="equipo.estaEnUso ? 'bi-stop-circle-fill' : 'bi-play-circle-fill'"></i>
              <span>{{ getTextoBoton(equipo) }}</span>
            </div>
            <div class="btn-ripple"></div>
          </button>

        </div>

        <!-- Card glow effect -->
        <div class="card-glow" [ngClass]="{'active-glow': equipo.estaEnUso}"></div>
      </ng-container>
    </div>
  </div>

  <!-- Sin equipos - Mejorado -->
  <div *ngIf="equipos.length === 0 && !estaActualizando" class="no-equipment">
    <div class="no-equipment-icon">
      <i class="bi bi-inbox"></i>
    </div>
    <div class="no-equipment-text">
      <h4>No hay equipos disponibles</h4>
      <p>Intenta recargar o verifica tu conexión</p>
    </div>
  </div>

</div>